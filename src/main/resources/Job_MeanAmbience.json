{
  "jobId": "meanAmbienceJob",
  "dataSources": [
    {
      "dataSchemaIds": [
        "VCNLSchema"
      ],
      "type": "topic",
      "topicProperties": {
        "topicName": "system.devices.*.sensors.VCNLSensor"
      }
    }
  ],
  "transformations": {
    "engine": "system:service:analytics:engine:sqe",
    "sqeTasks": [
      {
        "query": "from meanAmbienceJob_VCNLSchema#window.timeBatch(10 sec) select device,avg(ambience) as avgAmbience group by device insert into averageAmbienceStream;",
        "outputs": [
          {
            "name": "meanAmbienceResult",
            "dataSchemaId": "meanAmbience"
          }
        ]
      },
      {
        "query": "from averageAmbienceStream[avgAmbience > 4000] select device,avgAmbience insert into ambienceViolatedStream;",
        "outputs": [
          {
            "name": "meanViolatedResult",
            "dataSchemaId": "meanAmbience"
          }
        ]
      }
    ]
  },
  "exports": [
    {
      "outputName": "meanAmbienceResult",
      "type": "topic",
      "topicProperties": {
        "topicName": "meanAmbience"
      }
    },
    {
      "outputName": "meanViolatedResult",
      "type": "topic",
      "topicProperties": {
        "topicName": "meanAmbienceViolated"
      }
    }
  ]
}